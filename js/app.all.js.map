{"version":3,"file":"www/js/app.all.js","sources":["app/js/app.coffee","app/js/algolia/index.coffee","app/js/search/index.coffee"],"names":[],"mappings":"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","sourcesContent":["'use strict'\n\nApp = angular.module('app', [\n  'ngSanitize'\n  'ui.router'\n  'ui.bootstrap'\n\n  # Internal\n  'app.algolia'\n  'app.search'\n])\n\nApp\n  .config ($stateProvider, $urlRouterProvider, $locationProvider, $tooltipProvider) ->\n    $locationProvider.html5Mode true\n    $urlRouterProvider.otherwise(\"/\")\n    $stateProvider\n      .state 'search',\n        url: '/'\n        templateUrl: '/templates/search.html'\n        controller: 'SearchCtrl'\n      .state 'detail',\n        url: '/library/:name'\n        templateUrl: '/templates/detail.html'\n        controller: 'DetailCtrl'\n    $tooltipProvider.setTriggers( 'open': 'close' );\n    ZeroClipboard.config\n      moviePath: '//cdn.jsdelivr.net/zeroclipboard/1.3.3/ZeroClipboard.swf'\n      debug: true\n      trustedDomains: [\"*\"]\n      allowScriptAccess: \"always\"\n      forceHandCursor: true\n\n  .directive 'diClip', ->\n    restrict: 'A'\n\n    link: (scope, element, attrs) ->\n      text = 'copy to clipboard'\n      scope.tooltip = text\n      clip = new ZeroClipboard(element)\n\n      clip.on \"load\", (client) ->\n        client.on 'mouseover', ->\n          element.triggerHandler 'mouseenter'\n        client.on 'mouseout', ->\n          element.triggerHandler 'mouseleave'\n          scope.tooltip = text\n        client.on 'complete', ->\n          scope.$apply ->\n            scope.tooltip = 'copied!'\n          element.triggerHandler 'mouseleave'\n          element.triggerHandler 'mouseenter'\n        scope.$on \"$destroy\", ->\n          client.unclip element\n\n","angular.module('app.algolia', [])\n  .service 'AlgoliaClient', ->\n    new AlgoliaSearch('OMJJSUW8EV', '677bfc2f1458fa602cb88c825c4d531b')\n\n  .factory 'AlgoliaIndex', (AlgoliaClient, $q) ->\n    class Index\n      constructor: (name) ->\n        @index = AlgoliaClient.initIndex(name)\n\n      search: (params = {}) ->\n        deferred = $q.defer()\n        query = params.q || \"\"\n        delete params.q\n        @index.search(query, (s, result) ->\n          deferred.resolve(result)\n        , params)\n        deferred.promise\n\n      getObject: (id, params) ->\n        deferred = $q.defer()\n\n        @index.getObject(id, (s, result) ->\n          deferred.resolve(result)\n        , params)\n        deferred.promise\n","angular.module('app.search', [])\n  .factory 'SearchResponse', ->\n    class SearchResponse\n      constructor: (scope, response) ->\n        scope.hits = @hits(response)\n        console.log _.first scope.hits\n        scope.info = @info(response)\n        scope.page = @page(response)\n        console.log scope.page\n\n      info: (data) ->\n        start_index = data.page * data.hitsPerPage\n        stop_index = Math.min(start_index + data.hitsPerPage, data.nbHits)\n        resp =\n          start: Math.min(start_index + 1, data.nbHits)\n          stop: stop_index\n          time: data.processingTimeMS\n          total: data.nbHits\n\n      hits: (data) ->\n        data.hits\n\n      page: (data) ->\n        current = data.page\n        resp =\n          current: current\n          prev: current - 1\n          hasPrev: current != 0\n          hasNext: current < data.nbPages - 1\n          next: current + 1\n\n  .service 'Library', (AlgoliaIndex, $location, SearchResponse) ->\n    index = new AlgoliaIndex('jsdelivr')\n\n    class Library\n      get: (id, params) ->\n        index.getObject(id, params)\n      search: (scope) ->\n        state = $location.search()\n        params =\n          hitsPerPage: 25\n          facets: ['*']\n          maxValuesPerFacet: 10\n          facetFilters: []\n          attributesToRetrieve: ['description', 'name', 'lastversion']\n          q: state.q\n\n        params.page = state.page if state.page\n        scope.hits = null\n        index.search(params).then (response) ->\n          new SearchResponse(scope, response)\n    new Library()\n\n  .controller 'DetailCtrl', ($scope, $stateParams, Library) ->\n    $scope.copy_as = 'url'\n    Library.get($stateParams.name).then (res) ->\n      res.selected_version = res.lastversion\n      res.assets = _.indexBy(res.assets, 'version')\n      $scope.lib = res\n\n    $scope.file_url = ->\n      \"//cdn.jsdelivr.net/#{@lib.selected_version}/#{@file}\"\n\n\n  .controller 'SearchCtrl', ($scope, $location, Library) ->\n    $scope.search = $location.search().q\n    Library.search($scope)\n\n    $scope.reset = ->\n      $location.search({})\n      Library.search($scope)\n\n    $scope.select = (param_key, value) ->\n      $location.search('page', null)\n      value = null if value == \"\"\n      $location.search(param_key, value)\n      Library.search($scope)\n\n    $scope.select_page = (page) ->\n      return if page < 0\n      page = null if page == 0\n      $location.search('page', page)\n      Library.search($scope)\n"]}